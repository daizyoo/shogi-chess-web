# ゲーム同期の最適化と問題修正

## 変更内容

### 1. ポーリング間隔の最適化

- **変更前**: 2 秒ごと
- **変更後**: 5 秒ごと
- **理由**: 通信量削減のため

### 2. ターン検出ロジックの改善

- `lastKnownTurn`変数を追加して、実際にターンが変わったときのみ更新
- より確実なログ出力

### 3. デバッグログの追加

- `handleMove`で詳細なログを追加
- ポーリングでのターン変更を明確に表示

## テスト手順

1. ブラウザを完全にリロード（Cmd+Shift+R）
2. コンソールを開く
3. タブ 1: 新しいルームを作成
4. タブ 2: ルームに参加
5. タブ 1 で駒を動かす
6. 以下のログを確認:
   - タブ 1: `Move sent successfully, updating local state to turn: 2`
   - タブ 2（5 秒以内）: `Polling: Turn changed from 1 to 2`

## 期待される動作

- タブ 1 で手を指す → 即座に「相手のターンを待っています」に変わる
- タブ 2 で 5 秒以内に盤面が更新され「あなたのターンです」に変わる
- ポーリングは 5 秒ごとのみ（通信量削減）

## もし動作しない場合

コンソールに表示されるログをすべて共有してください：

- `Player info:` の内容
- `handleMove:` の内容
- `Move sent successfully` が表示されるか
- `Polling: Turn changed` が表示されるか
